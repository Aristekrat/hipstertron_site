/*! hipster_tron 21-11-2014 */
"use strict";angular.module("hipstertron",["ngRoute","hipstertron.services","hipstertron.controllers","angulartics","angulartics.google.analytics"]).config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){$routeProvider.when("/",{templateUrl:"partials/main.html",controller:"MainCtrl"}),$routeProvider.when("/calendar",{templateUrl:"partials/calendar.html",controller:"CalendarCtrl"}),$routeProvider.when("/info/:type",{templateUrl:"partials/info.html",controller:"InfoCtrl"}),$routeProvider.when("/signup",{templateUrl:"partials/signup.html",controller:"SignUpCtrl"}),$routeProvider.when("/privacy-policy",{templateUrl:"partials/privacy-policy.html",controller:"PrivacyCtrl"}),$routeProvider.otherwise({redirectTo:"/"}),$locationProvider.html5Mode(!0).hashPrefix("!")}]),angular.module("hipstertron.controllers",[]).controller("MainCtrl",["$scope","submitEmailService",function($scope,submitEmailService){$scope.userEmail={},$scope.userEmail.frequency="weekly",$scope.signUserUp=function(userEmail){userEmail.email?($scope.emailPlease=!1,submitEmailService.submitEmail(userEmail,function(){$scope.signedUp=!0})):$scope.emailPlease=!0}}]).controller("CalendarCtrl",["$scope","getConcertsService",function($scope,getConcertsService){$scope.concertListings={};var resultCount=120,offset=0,runCount=[];runCount.push(resultCount),getConcertsService.getConcerts(resultCount,offset,function(response){$scope.concertListings=response.data.concertListings}),$(window).scroll(function(){$(this).scrollTop()+1e3>$(document).height()-$(window).height()&&1===runCount.length&&(resultCount=500,runCount.push(resultCount),getConcertsService.getConcerts(resultCount,runCount[0],function(response){$scope.concertListings=$scope.concertListings.concat(response.data.concertListings)}))})}]).controller("InfoCtrl",["$scope","$routeParams",function($scope,$routeParams){function activateNav(correctNav){for(var navOptions=["aboutActive","findActive","reserveActive","cheapActive"],i=0;navOptions.length>i;i++){var t=navOptions[i];$scope[t]=navOptions[i]===correctNav?"info-link-active":""}}"about-hipstertron"===$routeParams.type?($scope.aboutRequested=!0,activateNav("aboutActive")):"find-tickets"===$routeParams.type?($scope.findRequested=!0,activateNav("findActive")):"reserve-tickets"===$routeParams.type?($scope.reserveRequested=!0,activateNav("reserveActive")):"cheap-tickets"===$routeParams.type?($scope.cheapRequested=!0,activateNav("cheapActive")):($scope.aboutRequested=!0,activateNav("aboutActive"))}]).controller("SignUpCtrl",["$scope","submitEmailService",function($scope,submitEmailService){$scope.userEmail={},$scope.userEmail.frequency="weekly",$scope.signUserUp=function(userEmail){userEmail.email?($scope.emailPlease=!1,submitEmailService.submitEmail(userEmail,function(){$scope.signedUp=!0})):$scope.emailPlease=!0}}]).controller("PrivacyCtrl",["$scope",function(){}]),angular.module("hipstertron.services",[]).factory("environmentService",["$http",function(){return{getPrefix:function(){var envPrefix={prod:"http://hipstertron-data.herokuapp.com",local:"http://localhost:8000"};return envPrefix.local}}}]).factory("submitEmailService",["$http","environmentService",function($http,environmentService){return{submitEmail:function(email,callback){$http({method:"POST",url:environmentService.getPrefix()+"/sendEmail",headers:{"Content-Type":"application/json"},data:JSON.stringify(email)}).then(function(response){return callback(response)})}}}]).factory("getConcertsService",["$http","environmentService",function($http,environmentService){return{getConcerts:function(resultCount,offset,callback){$http.get(environmentService.getPrefix()+"/getConcerts/"+resultCount+"/"+offset,{cache:!0}).then(function(response){return callback(response)})}}}]);